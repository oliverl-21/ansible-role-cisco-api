---
# Gather required Data for Version, Model and os-type
- name: Gather default facts
  cisco.ios.ios_facts:
    gather_subset: min

# get oauth2 token
- name: cisco api login
  ansible.builtin.uri:
    url: https://cloudsso.cisco.com/as/token.oauth2
    headers:
      Content-Type: application/x-www-form-urlencoded
    method: POST
    body:
      grant_type: client_credentials
      client_id: "{{ client_id }}"
      client_secret: "{{ client_secret }}"
    body_format: form-urlencoded
  register: ciscoapitoken
  delegate_to: localhost

- name: PSIRT
  ansible.builtin.import_tasks: psirt.yml
  when: psirt is defined and ansible_facts.net_system == 'ios'
